<!DOCTYPE html>
<html lang="fa" dir="rtl" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>پنل مدیریت - سینما دانلود</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        
        @import url('https://cdn.jsdelivr.net/gh/rastikerdar/vazir-font@v30.1.0/dist/font-face.css');
        
        * {
            font-family: 'Vazir', sans-serif;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d1b1b 50%, #1a1a1a 100%);
        }
        
        .admin-card {
            transition: all 0.3s ease;
            background: linear-gradient(145deg, #374151, #1f2937);
        }
        
        .admin-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(220, 38, 38, 0.2);
        }
        
        .sidebar-item {
            transition: all 0.3s ease;
        }
        
        .sidebar-item:hover {
            background: linear-gradient(90deg, rgba(220, 38, 38, 0.2), rgba(239, 68, 68, 0.1));
            border-right: 4px solid #dc2626;
        }
        
        .sidebar-item.active {
            background: linear-gradient(90deg, rgba(220, 38, 38, 0.3), rgba(239, 68, 68, 0.2));
            border-right: 4px solid #dc2626;
        }
        
        .notification {
            animation: slideIn 0.3s ease-out;
        }
        
        .download-link-item {
            background: rgba(55, 65, 81, 0.5);
            border: 1px solid #4b5563;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 8px;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body class="h-full bg-black text-white">
    <!-- Login Screen -->
    <div id="loginScreen" class="min-h-full flex items-center justify-center bg-gradient-to-br from-black via-gray-900 to-black">
        <div class="max-w-md w-full mx-4">
            <div class="bg-gray-900 p-8 rounded-lg border border-red-500 shadow-2xl">
                <div class="text-center mb-8">
                    <div class="text-4xl mb-4">🔐</div>
                    <h2 class="text-2xl font-bold text-white">پنل مدیریت</h2>
                    <p class="text-gray-400 mt-2">سینما دانلود</p>
                </div>
                
                <form id="adminLoginForm" class="space-y-6">
                    <div>
                        <label for="adminUsername" class="block text-white font-medium mb-2">نام کاربری:</label>
                        <input type="text" id="adminUsername" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-red-500" placeholder="نام کاربری" required>
                    </div>
                    
                    <div>
                        <label for="adminPassword" class="block text-white font-medium mb-2">رمز عبور:</label>
                        <input type="password" id="adminPassword" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-red-500" placeholder="رمز عبور" required>
                    </div>
                    
                    <button type="submit" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-lg transition-colors">
                        ورود به پنل
                    </button>
                </form>
                
                <div class="mt-6 text-center">
                    <a href="index.html" class="text-red-400 hover:text-red-300 text-sm">بازگشت به سایت اصلی</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="adminDashboard" class="hidden min-h-full">
        <!-- Header -->
        <header class="gradient-bg shadow-lg border-b border-red-500">
            <div class="px-6 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4 space-x-reverse">
                        <div class="text-2xl">👑</div>
                        <div>
                            <h1 class="text-xl font-bold text-red-400">پنل مدیریت</h1>
                            <p class="text-gray-400 text-sm">سینما دانلود</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center space-x-4 space-x-reverse">
                        <div class="text-sm text-gray-400">
                            <span id="currentDateTime"></span>
                        </div>
                        <button id="logoutBtn" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors">
                            خروج
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <div class="flex h-screen">
            <!-- Sidebar -->
            <aside class="w-64 bg-gray-900 border-l border-red-500">
                <nav class="mt-6">
                    <div class="px-4 space-y-2">
                        <button class="sidebar-item active w-full text-right px-4 py-3 text-white rounded-lg" data-section="dashboard">
                            📊 داشبورد
                        </button>
                        <button class="sidebar-item w-full text-right px-4 py-3 text-white rounded-lg" data-section="movies">
                            🎬 مدیریت فیلم‌ها
                        </button>
                        <button class="sidebar-item w-full text-right px-4 py-3 text-white rounded-lg" data-section="series">
                            📺 مدیریت سریال‌ها
                        </button>
                        <button class="sidebar-item w-full text-right px-4 py-3 text-white rounded-lg" data-section="users">
                            👥 مدیریت کاربران
                        </button>
                        <button class="sidebar-item w-full text-right px-4 py-3 text-white rounded-lg" data-section="settings">
                            ⚙️ تنظیمات
                        </button>
                    </div>
                </nav>
            </aside>

            <!-- Main Content -->
            <main class="flex-1 overflow-y-auto bg-gray-800">
                <!-- Dashboard Section -->
                <div id="dashboardSection" class="section-content p-6">
                    <h2 class="text-2xl font-bold text-white mb-6">داشبورد مدیریت</h2>
                    
                    <!-- Stats Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="admin-card p-6 rounded-lg border border-gray-700">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-400 text-sm">کل فیلم‌ها</p>
                                    <p class="text-2xl font-bold text-white" id="totalMovies">0</p>
                                </div>
                                <div class="text-3xl">🎬</div>
                            </div>
                        </div>
                        
                        <div class="admin-card p-6 rounded-lg border border-gray-700">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-400 text-sm">کل سریال‌ها</p>
                                    <p class="text-2xl font-bold text-white" id="totalSeries">0</p>
                                </div>
                                <div class="text-3xl">📺</div>
                            </div>
                        </div>
                        
                        <div class="admin-card p-6 rounded-lg border border-gray-700">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-400 text-sm">کل کاربران</p>
                                    <p class="text-2xl font-bold text-white" id="totalUsers">0</p>
                                </div>
                                <div class="text-3xl">👥</div>
                            </div>
                        </div>
                        
                        <div class="admin-card p-6 rounded-lg border border-gray-700">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-400 text-sm">کل دانلودها</p>
                                    <p class="text-2xl font-bold text-white" id="totalDownloads">0</p>
                                </div>
                                <div class="text-3xl">⬇️</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Movies Section -->
                <div id="moviesSection" class="section-content hidden p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold text-white">مدیریت فیلم‌ها</h2>
                        <button id="addMovieBtn" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors">
                            ➕ افزودن فیلم
                        </button>
                    </div>

                    <!-- Movies Table -->
                    <div class="bg-gray-900 rounded-lg border border-gray-700 overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-800">
                                    <tr>
                                        <th class="px-6 py-3 text-right text-white font-medium">نام فیلم</th>
                                        <th class="px-6 py-3 text-right text-white font-medium">ژانر</th>
                                        <th class="px-6 py-3 text-right text-white font-medium">سال</th>
                                        <th class="px-6 py-3 text-right text-white font-medium">کیفیت‌ها</th>
                                        <th class="px-6 py-3 text-right text-white font-medium">دانلود</th>
                                        <th class="px-6 py-3 text-right text-white font-medium">عملیات</th>
                                    </tr>
                                </thead>
                                <tbody id="moviesTableBody" class="divide-y divide-gray-700">
                                    <!-- Movies will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Series Section -->
                <div id="seriesSection" class="section-content hidden p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold text-white">مدیریت سریال‌ها</h2>
                        <button id="addSeriesBtn" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors">
                            ➕ افزودن سریال
                        </button>
                    </div>

                    <!-- Series Table -->
                    <div class="bg-gray-900 rounded-lg border border-gray-700 overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-800">
                                    <tr>
                                        <th class="px-6 py-3 text-right text-white font-medium">نام سریال</th>
                                        <th class="px-6 py-3 text-right text-white font-medium">ژانر</th>
                                        <th class="px-6 py-3 text-right text-white font-medium">سال</th>
                                        <th class="px-6 py-3 text-right text-white font-medium">فصل</th>
                                        <th class="px-6 py-3 text-right text-white font-medium">کیفیت‌ها</th>
                                        <th class="px-6 py-3 text-right text-white font-medium">عملیات</th>
                                    </tr>
                                </thead>
                                <tbody id="seriesTableBody" class="divide-y divide-gray-700">
                                    <!-- Series will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Users Section -->
                <div id="usersSection" class="section-content hidden p-6">
                    <h2 class="text-2xl font-bold text-white mb-6">مدیریت کاربران</h2>
                    
                    <div class="bg-gray-900 rounded-lg border border-gray-700 overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-800">
                                    <tr>
                                        <th class="px-6 py-3 text-right text-white font-medium">نام کاربری</th>
                                        <th class="px-6 py-3 text-right text-white font-medium">ایمیل</th>
                                        <th class="px-6 py-3 text-right text-white font-medium">تاریخ عضویت</th>
                                        <th class="px-6 py-3 text-right text-white font-medium">نوع اشتراک</th>
                                        <th class="px-6 py-3 text-right text-white font-medium">وضعیت</th>
                                    </tr>
                                </thead>
                                <tbody id="usersTableBody" class="divide-y divide-gray-700">
                                    <!-- Users will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Settings Section -->
                <div id="settingsSection" class="section-content hidden p-6">
                    <h2 class="text-2xl font-bold text-white mb-6">تنظیمات سایت</h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-gray-900 rounded-lg border border-gray-700 p-6">
                            <h3 class="text-xl font-bold text-white mb-4">قیمت اشتراک‌ها</h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-white mb-2">اشتراک ماهانه (تومان):</label>
                                    <input type="number" id="monthlyPrice" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                                </div>
                                <div>
                                    <label class="block text-white mb-2">اشتراک سالانه (تومان):</label>
                                    <input type="number" id="yearlyPrice" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                                </div>
                                <div>
                                    <label class="block text-white mb-2">اشتراک VIP (تومان):</label>
                                    <input type="number" id="vipPrice" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                                </div>
                                <button id="savePricesBtn" class="w-full bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg transition-colors">
                                    ذخیره قیمت‌ها
                                </button>
                            </div>
                        </div>
                        
                        <div class="bg-gray-900 rounded-lg border border-gray-700 p-6">
                            <h3 class="text-xl font-bold text-white mb-4">تنظیمات عمومی</h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-white mb-2">نام سایت:</label>
                                    <input type="text" id="siteName" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                                </div>
                                <div>
                                    <label class="block text-white mb-2">توضیحات سایت:</label>
                                    <textarea id="siteDescription" rows="3" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500"></textarea>
                                </div>
                                <button id="saveSettingsBtn" class="w-full bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg transition-colors">
                                    ذخیره تنظیمات
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Add Movie Modal -->
    <div id="addMovieModal" class="hidden fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4">
        <div class="bg-gray-900 rounded-lg max-w-4xl w-full border border-red-500 max-h-96 overflow-y-auto">
            <div class="p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-white">افزودن فیلم جدید</h3>
                    <button onclick="closeModal('addMovieModal')" class="text-red-400 hover:text-red-300 text-2xl">✕</button>
                </div>
                
                <form id="addMovieForm" class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-white mb-2">نام فیلم:</label>
                            <input type="text" name="name" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                        </div>
                        <div>
                            <label class="block text-white mb-2">نام انگلیسی:</label>
                            <input type="text" name="nameEn" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                        </div>
                        <div>
                            <label class="block text-white mb-2">ژانر:</label>
                            <select name="genre" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                                <option value="">انتخاب ژانر</option>
                                <option value="اکشن">اکشن</option>
                                <option value="کمدی">کمدی</option>
                                <option value="درام">درام</option>
                                <option value="ترسناک">ترسناک</option>
                                <option value="فانتزی">فانتزی</option>
                                <option value="جنایی">جنایی</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-white mb-2">سال:</label>
                            <input type="number" name="year" required min="1900" max="2030" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                        </div>
                        <div>
                            <label class="block text-white mb-2">کشور:</label>
                            <input type="text" name="country" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                        </div>
                        <div>
                            <label class="block text-white mb-2">کارگردان:</label>
                            <input type="text" name="director" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                        </div>
                        <div>
                            <label class="block text-white mb-2">امتیاز:</label>
                            <input type="number" step="0.1" min="0" max="10" name="rating" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                        </div>
                        <div>
                            <label class="block text-white mb-2">مدت زمان (دقیقه):</label>
                            <input type="number" name="duration" min="1" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-white mb-2">بازیگران:</label>
                        <input type="text" name="stars" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                    </div>
                    
                    <div>
                        <label class="block text-white mb-2">خلاصه داستان:</label>
                        <textarea name="description" rows="3" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500"></textarea>
                    </div>
                    
                    <!-- Download Links Section -->
                    <div class="bg-gray-800 rounded-lg p-4 mb-4">
                        <h4 class="text-white font-bold mb-4 flex items-center">
                            🔗 لینک‌های دانلود
                            <button type="button" id="addMovieDownloadLink" class="mr-4 bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm transition-colors">
                                ➕ افزودن لینک
                            </button>
                        </h4>
                        <div id="movieDownloadLinks" class="space-y-3">
                            <div class="download-link-item">
                                <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
                                    <div>
                                        <label class="block text-white mb-1 text-sm">کیفیت:</label>
                                        <select name="downloadQuality[]" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-red-500">
                                            <option value="480p">480p</option>
                                            <option value="720p">720p</option>
                                            <option value="1080p" selected>1080p</option>
                                            <option value="4K">4K</option>
                                            <option value="BluRay">BluRay</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-white mb-1 text-sm">حجم فایل:</label>
                                        <input type="text" name="downloadSize[]" placeholder="مثال: 2.5 GB" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-red-500">
                                    </div>
                                    <div>
                                        <label class="block text-white mb-1 text-sm">لینک دانلود:</label>
                                        <input type="url" name="downloadLink[]" placeholder="https://example.com/download" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-red-500">
                                    </div>
                                    <div class="flex items-end">
                                        <button type="button" onclick="removeDownloadLink(this)" class="bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded text-sm transition-colors">
                                            🗑️ حذف
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-white mb-2">دوبله:</label>
                            <select name="dubbed" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                                <option value="دوبله فارسی">دوبله فارسی</option>
                                <option value="زیرنویس فارسی">زیرنویس فارسی</option>
                                <option value="دوبله و زیرنویس">دوبله و زیرنویس</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-white mb-2">نوع:</label>
                            <select name="type" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                                <option value="free">رایگان</option>
                                <option value="premium">پریمیوم</option>
                                <option value="vip">VIP</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-white mb-2">وضعیت:</label>
                            <select name="status" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                                <option value="active">فعال</option>
                                <option value="inactive">غیرفعال</option>
                                <option value="pending">در انتظار</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="flex gap-3 pt-4">
                        <button type="submit" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg transition-colors">
                            افزودن فیلم
                        </button>
                        <button type="button" onclick="closeModal('addMovieModal')" class="flex-1 bg-gray-700 hover:bg-gray-600 text-white py-2 px-4 rounded-lg transition-colors">
                            انصراف
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Add Series Modal -->
    <div id="addSeriesModal" class="hidden fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4">
        <div class="bg-gray-900 rounded-lg max-w-4xl w-full border border-red-500 max-h-96 overflow-y-auto">
            <div class="p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-white">افزودن سریال جدید</h3>
                    <button onclick="closeModal('addSeriesModal')" class="text-red-400 hover:text-red-300 text-2xl">✕</button>
                </div>
                
                <form id="addSeriesForm" class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-white mb-2">نام سریال:</label>
                            <input type="text" name="name" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                        </div>
                        <div>
                            <label class="block text-white mb-2">نام انگلیسی:</label>
                            <input type="text" name="nameEn" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                        </div>
                        <div>
                            <label class="block text-white mb-2">ژانر:</label>
                            <select name="genre" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                                <option value="">انتخاب ژانر</option>
                                <option value="اکشن">اکشن</option>
                                <option value="کمدی">کمدی</option>
                                <option value="درام">درام</option>
                                <option value="ترسناک">ترسناک</option>
                                <option value="فانتزی">فانتزی</option>
                                <option value="جنایی">جنایی</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-white mb-2">سال:</label>
                            <input type="number" name="year" required min="1900" max="2030" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                        </div>
                        <div>
                            <label class="block text-white mb-2">تعداد فصل:</label>
                            <input type="number" name="seasons" required min="1" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                        </div>
                        <div>
                            <label class="block text-white mb-2">تعداد قسمت:</label>
                            <input type="number" name="episodes" required min="1" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                        </div>
                        <div>
                            <label class="block text-white mb-2">کشور:</label>
                            <input type="text" name="country" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                        </div>
                        <div>
                            <label class="block text-white mb-2">امتیاز:</label>
                            <input type="number" step="0.1" min="0" max="10" name="rating" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-white mb-2">کارگردان:</label>
                        <input type="text" name="director" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                    </div>
                    
                    <div>
                        <label class="block text-white mb-2">بازیگران:</label>
                        <input type="text" name="stars" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                    </div>
                    
                    <div>
                        <label class="block text-white mb-2">خلاصه داستان:</label>
                        <textarea name="description" rows="3" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500"></textarea>
                    </div>
                    
                    <!-- Download Links Section for Series -->
                    <div class="bg-gray-800 rounded-lg p-4 mb-4">
                        <h4 class="text-white font-bold mb-4 flex items-center">
                            🔗 لینک‌های دانلود
                            <button type="button" id="addSeriesDownloadLink" class="mr-4 bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm transition-colors">
                                ➕ افزودن لینک
                            </button>
                        </h4>
                        <div id="seriesDownloadLinks" class="space-y-3">
                            <div class="download-link-item">
                                <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
                                    <div>
                                        <label class="block text-white mb-1 text-sm">کیفیت:</label>
                                        <select name="downloadQuality[]" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-red-500">
                                            <option value="480p">480p</option>
                                            <option value="720p">720p</option>
                                            <option value="1080p" selected>1080p</option>
                                            <option value="4K">4K</option>
                                            <option value="BluRay">BluRay</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-white mb-1 text-sm">حجم فایل:</label>
                                        <input type="text" name="downloadSize[]" placeholder="مثال: 15 GB (کل فصل)" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-red-500">
                                    </div>
                                    <div>
                                        <label class="block text-white mb-1 text-sm">لینک دانلود:</label>
                                        <input type="url" name="downloadLink[]" placeholder="https://example.com/download" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-red-500">
                                    </div>
                                    <div class="flex items-end">
                                        <button type="button" onclick="removeDownloadLink(this)" class="bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded text-sm transition-colors">
                                            🗑️ حذف
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-white mb-2">دوبله:</label>
                            <select name="dubbed" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                                <option value="دوبله فارسی">دوبله فارسی</option>
                                <option value="زیرنویس فارسی">زیرنویس فارسی</option>
                                <option value="دوبله و زیرنویس">دوبله و زیرنویس</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-white mb-2">نوع:</label>
                            <select name="type" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                                <option value="free">رایگان</option>
                                <option value="premium">پریمیوم</option>
                                <option value="vip">VIP</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-white mb-2">وضعیت:</label>
                            <select name="status" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-red-500">
                                <option value="active">فعال</option>
                                <option value="inactive">غیرفعال</option>
                                <option value="pending">در انتظار</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="flex gap-3 pt-4">
                        <button type="submit" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg transition-colors">
                            افزودن سریال
                        </button>
                        <button type="button" onclick="closeModal('addSeriesModal')" class="flex-1 bg-gray-700 hover:bg-gray-600 text-white py-2 px-4 rounded-lg transition-colors">
                            انصراف
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Data Management System
        class DataManager {
            constructor() {
                this.storageKey = 'cinemaDownloadData';
                this.init();
            }

            init() {
                if (!this.getData()) {
                    this.setDefaultData();
                }
            }

            getData() {
                try {
                    const data = localStorage.getItem(this.storageKey);
                    return data ? JSON.parse(data) : null;
                } catch (error) {
                    console.error('Error loading data:', error);
                    return null;
                }
            }

            saveData(data) {
                try {
                    localStorage.setItem(this.storageKey, JSON.stringify(data));
                    window.dispatchEvent(new StorageEvent('storage', {
                        key: this.storageKey,
                        newValue: JSON.stringify(data)
                    }));
                    return true;
                } catch (error) {
                    console.error('Error saving data:', error);
                    return false;
                }
            }

            setDefaultData() {
                const defaultData = {
                    movies: [
                        {
                            id: 1,
                            name: 'اونجرز: پایان بازی',
                            nameEn: 'Avengers: Endgame',
                            genre: 'اکشن',
                            year: 2019,
                            country: 'آمریکا',
                            director: 'برادران روسو',
                            stars: 'رابرت داونی جونیور، کریس ایوانز',
                            rating: 8.4,
                            duration: 181,
                            quality: '4K, 1080p, 720p',
                            dubbed: 'دوبله فارسی',
                            type: 'premium',
                            status: 'active',
                            downloads: 15420,
                            views: 45230,
                            description: 'نبرد نهایی قهرمانان با تانوس',
                            poster: '🦸‍♂️',
                            addedDate: '۱۴۰۳/۰۶/۱۵',
                            category: 'movie',
                            downloadLinks: [
                                { quality: '4K', size: '8.5 GB', link: 'https://example.com/avengers-4k' },
                                { quality: '1080p', size: '3.2 GB', link: 'https://example.com/avengers-1080p' },
                                { quality: '720p', size: '1.8 GB', link: 'https://example.com/avengers-720p' }
                            ]
                        },
                        {
                            id: 2,
                            name: 'جوکر',
                            nameEn: 'Joker',
                            genre: 'درام',
                            year: 2019,
                            country: 'آمریکا',
                            director: 'تاد فیلیپس',
                            stars: 'خواکین فینیکس، رابرت دنیرو',
                            rating: 8.5,
                            duration: 122,
                            quality: '1080p, 720p',
                            dubbed: 'زیرنویس فارسی',
                            type: 'vip',
                            status: 'active',
                            downloads: 12890,
                            views: 38450,
                            description: 'داستان تبدیل آرتور به جوکر',
                            poster: '🃏',
                            addedDate: '۱۴۰۳/۰۶/۲۰',
                            category: 'movie',
                            downloadLinks: [
                                { quality: '1080p', size: '2.8 GB', link: 'https://example.com/joker-1080p' },
                                { quality: '720p', size: '1.5 GB', link: 'https://example.com/joker-720p' }
                            ]
                        }
                    ],
                    series: [
                        {
                            id: 1,
                            name: 'بازی تاج و تخت',
                            nameEn: 'Game of Thrones',
                            genre: 'فانتزی',
                            year: 2011,
                            country: 'آمریکا',
                            director: 'دیوید بنیوف',
                            stars: 'پیتر دینکلیج، امیلیا کلارک',
                            rating: 9.3,
                            seasons: 8,
                            episodes: 73,
                            quality: '1080p, 720p',
                            dubbed: 'دوبله فارسی',
                            type: 'vip',
                            status: 'active',
                            downloads: 25670,
                            views: 78920,
                            description: 'نبرد برای تاج و تخت آهنین',
                            poster: '👑',
                            addedDate: '۱۴۰۳/۰۵/۱۰',
                            category: 'series',
                            downloadLinks: [
                                { quality: '1080p', size: '45 GB (کل سریال)', link: 'https://example.com/got-1080p' },
                                { quality: '720p', size: '25 GB (کل سریال)', link: 'https://example.com/got-720p' }
                            ]
                        }
                    ],
                    users: [
                        {
                            id: 1,
                            username: 'علی_احمدی',
                            email: 'ali@example.com',
                            joinDate: '۱۴۰۳/۰۶/۱۰',
                            subscriptionType: 'vip',
                            status: 'active'
                        },
                        {
                            id: 2,
                            username: 'مریم_محمدی',
                            email: 'maryam@example.com',
                            joinDate: '۱۴۰۳/۰۷/۱۵',
                            subscriptionType: 'premium',
                            status: 'active'
                        }
                    ],
                    settings: {
                        siteName: 'سینما دانلود',
                        siteDescription: 'بهترین سایت دانلود فیلم و سریال',
                        subscriptionPrices: {
                            monthly: 50000,
                            yearly: 400000,
                            vip: 500000
                        }
                    }
                };
                this.saveData(defaultData);
                return defaultData;
            }

            addMovie(movie) {
                const data = this.getData();
                const movies = data.movies || [];
                movie.id = Math.max(...movies.map(m => m.id), 0) + 1;
                movie.addedDate = new Date().toLocaleDateString('fa-IR');
                movie.downloads = 0;
                movie.views = 0;
                movie.status = movie.status || 'active';
                movie.poster = '🎬';
                movie.category = 'movie';
                
                // Process download links and set quality
                if (movie.downloadLinks && movie.downloadLinks.length > 0) {
                    movie.downloadLinks = movie.downloadLinks.filter(link => link.quality && link.link);
                    movie.quality = movie.downloadLinks.map(link => link.quality).join(', ');
                } else {
                    movie.downloadLinks = [];
                    movie.quality = '1080p';
                }
                
                movies.push(movie);
                data.movies = movies;
                return this.saveData(data);
            }

            addSeries(series) {
                const data = this.getData();
                const seriesList = data.series || [];
                series.id = Math.max(...seriesList.map(s => s.id), 0) + 1;
                series.addedDate = new Date().toLocaleDateString('fa-IR');
                series.downloads = 0;
                series.views = 0;
                series.status = series.status || 'active';
                series.poster = '📺';
                series.category = 'series';
                
                // Process download links and set quality
                if (series.downloadLinks && series.downloadLinks.length > 0) {
                    series.downloadLinks = series.downloadLinks.filter(link => link.quality && link.link);
                    series.quality = series.downloadLinks.map(link => link.quality).join(', ');
                } else {
                    series.downloadLinks = [];
                    series.quality = '1080p';
                }
                
                seriesList.push(series);
                data.series = seriesList;
                return this.saveData(data);
            }

            deleteMovie(id) {
                const data = this.getData();
                data.movies = data.movies.filter(m => m.id !== id);
                return this.saveData(data);
            }

            deleteSeries(id) {
                const data = this.getData();
                data.series = data.series.filter(s => s.id !== id);
                return this.saveData(data);
            }

            updateSettings(settings) {
                const data = this.getData();
                data.settings = { ...data.settings, ...settings };
                return this.saveData(data);
            }
        }

        // Initialize
        const dataManager = new DataManager();
        const ADMIN_CREDENTIALS = { username: 'admin', password: '123456' };

        // Login functionality
        document.getElementById('adminLoginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('adminUsername').value;
            const password = document.getElementById('adminPassword').value;
            
            if (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
                document.getElementById('loginScreen').classList.add('hidden');
                document.getElementById('adminDashboard').classList.remove('hidden');
                initializeDashboard();
                showNotification('ورود موفق به پنل مدیریت', 'success');
            } else {
                showNotification('نام کاربری یا رمز عبور اشتباه است', 'error');
            }
        });

        // Logout
        document.getElementById('logoutBtn').addEventListener('click', function() {
            document.getElementById('adminDashboard').classList.add('hidden');
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('adminUsername').value = '';
            document.getElementById('adminPassword').value = '';
        });

        // Initialize dashboard
        function initializeDashboard() {
            updateDateTime();
            setInterval(updateDateTime, 1000);
            updateStats();
            loadMoviesTable();
            loadSeriesTable();
            loadUsersTable();
            loadSettings();
            setupEventListeners();
        }

        // Update date time
        function updateDateTime() {
            const now = new Date();
            document.getElementById('currentDateTime').textContent = now.toLocaleString('fa-IR');
        }

        // Update statistics
        function updateStats() {
            const data = dataManager.getData();
            document.getElementById('totalMovies').textContent = data.movies.length;
            document.getElementById('totalSeries').textContent = data.series.length;
            document.getElementById('totalUsers').textContent = data.users.length;
            
            const totalDownloads = data.movies.reduce((sum, movie) => sum + movie.downloads, 0) +
                                 data.series.reduce((sum, series) => sum + series.downloads, 0);
            document.getElementById('totalDownloads').textContent = totalDownloads.toLocaleString();
        }

        // Load movies table
        function loadMoviesTable() {
            const data = dataManager.getData();
            const tbody = document.getElementById('moviesTableBody');
            tbody.innerHTML = '';
            
            data.movies.forEach(movie => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-800';
                row.innerHTML = `
                    <td class="px-6 py-4">
                        <div class="text-white font-medium">${movie.name}</div>
                        <div class="text-xs text-gray-400">${movie.nameEn || ''}</div>
                    </td>
                    <td class="px-6 py-4 text-gray-400">${movie.genre}</td>
                    <td class="px-6 py-4 text-gray-400">${movie.year}</td>
                    <td class="px-6 py-4">
                        <div class="text-blue-400 text-sm">${movie.quality}</div>
                        <div class="text-xs text-gray-500">${movie.downloadLinks ? movie.downloadLinks.length : 0} لینک</div>
                    </td>
                    <td class="px-6 py-4 text-green-400">${movie.downloads.toLocaleString()}</td>
                    <td class="px-6 py-4">
                        <div class="flex space-x-2 space-x-reverse">
                            <button onclick="viewDownloadLinks(${movie.id}, 'movie')" class="bg-blue-600 hover:bg-blue-700 text-white px-2 py-1 rounded text-xs transition-colors">
                                لینک‌ها
                            </button>
                            <button onclick="deleteMovie(${movie.id})" class="bg-red-600 hover:bg-red-700 text-white px-2 py-1 rounded text-xs transition-colors">
                                حذف
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Load series table
        function loadSeriesTable() {
            const data = dataManager.getData();
            const tbody = document.getElementById('seriesTableBody');
            tbody.innerHTML = '';
            
            data.series.forEach(series => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-800';
                row.innerHTML = `
                    <td class="px-6 py-4">
                        <div class="text-white font-medium">${series.name}</div>
                        <div class="text-xs text-gray-400">${series.nameEn || ''}</div>
                    </td>
                    <td class="px-6 py-4 text-gray-400">${series.genre}</td>
                    <td class="px-6 py-4 text-gray-400">${series.year}</td>
                    <td class="px-6 py-4 text-blue-400">${series.seasons} فصل</td>
                    <td class="px-6 py-4">
                        <div class="text-blue-400 text-sm">${series.quality}</div>
                        <div class="text-xs text-gray-500">${series.downloadLinks ? series.downloadLinks.length : 0} لینک</div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="flex space-x-2 space-x-reverse">
                            <button onclick="viewDownloadLinks(${series.id}, 'series')" class="bg-blue-600 hover:bg-blue-700 text-white px-2 py-1 rounded text-xs transition-colors">
                                لینک‌ها
                            </button>
                            <button onclick="deleteSeries(${series.id})" class="bg-red-600 hover:bg-red-700 text-white px-2 py-1 rounded text-xs transition-colors">
                                حذف
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Load users table
        function loadUsersTable() {
            const data = dataManager.getData();
            const tbody = document.getElementById('usersTableBody');
            tbody.innerHTML = '';
            
            data.users.forEach(user => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-800';
                row.innerHTML = `
                    <td class="px-6 py-4 text-white">${user.username}</td>
                    <td class="px-6 py-4 text-gray-400">${user.email}</td>
                    <td class="px-6 py-4 text-gray-400">${user.joinDate}</td>
                    <td class="px-6 py-4">
                        <span class="px-2 py-1 rounded text-xs ${user.subscriptionType === 'vip' ? 'bg-yellow-600' : user.subscriptionType === 'premium' ? 'bg-blue-600' : 'bg-gray-600'} text-white">
                            ${user.subscriptionType === 'vip' ? 'VIP' : user.subscriptionType === 'premium' ? 'پریمیوم' : 'رایگان'}
                        </span>
                    </td>
                    <td class="px-6 py-4">
                        <span class="px-2 py-1 rounded text-xs bg-green-600 text-white">فعال</span>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Load settings
        function loadSettings() {
            const data = dataManager.getData();
            const settings = data.settings;
            
            document.getElementById('monthlyPrice').value = settings.subscriptionPrices.monthly;
            document.getElementById('yearlyPrice').value = settings.subscriptionPrices.yearly;
            document.getElementById('vipPrice').value = settings.subscriptionPrices.vip;
            document.getElementById('siteName').value = settings.siteName;
            document.getElementById('siteDescription').value = settings.siteDescription;
        }

        // Setup event listeners
        function setupEventListeners() {
            // Sidebar navigation
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.addEventListener('click', function() {
                    document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    
                    document.querySelectorAll('.section-content').forEach(section => {
                        section.classList.add('hidden');
                    });
                    
                    document.getElementById(this.dataset.section + 'Section').classList.remove('hidden');
                });
            });

            // Add movie button
            document.getElementById('addMovieBtn').addEventListener('click', function() {
                document.getElementById('addMovieModal').classList.remove('hidden');
            });

            // Add series button
            document.getElementById('addSeriesBtn').addEventListener('click', function() {
                document.getElementById('addSeriesModal').classList.remove('hidden');
            });

            // Add download link buttons
            document.getElementById('addMovieDownloadLink').addEventListener('click', function() {
                addDownloadLinkField('movieDownloadLinks');
            });

            document.getElementById('addSeriesDownloadLink').addEventListener('click', function() {
                addDownloadLinkField('seriesDownloadLinks');
            });

            // Add movie form
            document.getElementById('addMovieForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const formData = new FormData(e.target);
                const movieData = Object.fromEntries(formData.entries());
                movieData.year = parseInt(movieData.year);
                movieData.rating = parseFloat(movieData.rating) || 0;
                movieData.duration = parseInt(movieData.duration) || 0;
                
                // Process download links
                const qualities = formData.getAll('downloadQuality[]');
                const sizes = formData.getAll('downloadSize[]');
                const links = formData.getAll('downloadLink[]');
                
                movieData.downloadLinks = [];
                for (let i = 0; i < qualities.length; i++) {
                    if (qualities[i] && links[i]) {
                        movieData.downloadLinks.push({
                            quality: qualities[i],
                            size: sizes[i] || '',
                            link: links[i]
                        });
                    }
                }
                
                if (dataManager.addMovie(movieData)) {
                    loadMoviesTable();
                    updateStats();
                    closeModal('addMovieModal');
                    showNotification('فیلم با موفقیت اضافه شد', 'success');
                    e.target.reset();
                    resetDownloadLinks('movieDownloadLinks');
                }
            });

            // Add series form
            document.getElementById('addSeriesForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const formData = new FormData(e.target);
                const seriesData = Object.fromEntries(formData.entries());
                seriesData.year = parseInt(seriesData.year);
                seriesData.rating = parseFloat(seriesData.rating) || 0;
                seriesData.seasons = parseInt(seriesData.seasons);
                seriesData.episodes = parseInt(seriesData.episodes);
                
                // Process download links
                const qualities = formData.getAll('downloadQuality[]');
                const sizes = formData.getAll('downloadSize[]');
                const links = formData.getAll('downloadLink[]');
                
                seriesData.downloadLinks = [];
                for (let i = 0; i < qualities.length; i++) {
                    if (qualities[i] && links[i]) {
                        seriesData.downloadLinks.push({
                            quality: qualities[i],
                            size: sizes[i] || '',
                            link: links[i]
                        });
                    }
                }
                
                if (dataManager.addSeries(seriesData)) {
                    loadSeriesTable();
                    updateStats();
                    closeModal('addSeriesModal');
                    showNotification('سریال با موفقیت اضافه شد', 'success');
                    e.target.reset();
                    resetDownloadLinks('seriesDownloadLinks');
                }
            });

            // Save prices
            document.getElementById('savePricesBtn').addEventListener('click', function() {
                const prices = {
                    subscriptionPrices: {
                        monthly: parseInt(document.getElementById('monthlyPrice').value),
                        yearly: parseInt(document.getElementById('yearlyPrice').value),
                        vip: parseInt(document.getElementById('vipPrice').value)
                    }
                };
                
                if (dataManager.updateSettings(prices)) {
                    showNotification('قیمت‌ها با موفقیت ذخیره شد', 'success');
                }
            });

            // Save settings
            document.getElementById('saveSettingsBtn').addEventListener('click', function() {
                const settings = {
                    siteName: document.getElementById('siteName').value,
                    siteDescription: document.getElementById('siteDescription').value
                };
                
                if (dataManager.updateSettings(settings)) {
                    showNotification('تنظیمات با موفقیت ذخیره شد', 'success');
                }
            });
        }

        // Add download link field
        function addDownloadLinkField(containerId) {
            const container = document.getElementById(containerId);
            const newLinkItem = document.createElement('div');
            newLinkItem.className = 'download-link-item';
            newLinkItem.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
                    <div>
                        <label class="block text-white mb-1 text-sm">کیفیت:</label>
                        <select name="downloadQuality[]" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-red-500">
                            <option value="480p">480p</option>
                            <option value="720p">720p</option>
                            <option value="1080p" selected>1080p</option>
                            <option value="4K">4K</option>
                            <option value="BluRay">BluRay</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-white mb-1 text-sm">حجم فایل:</label>
                        <input type="text" name="downloadSize[]" placeholder="مثال: 2.5 GB" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-red-500">
                    </div>
                    <div>
                        <label class="block text-white mb-1 text-sm">لینک دانلود:</label>
                        <input type="url" name="downloadLink[]" placeholder="https://example.com/download" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white text-sm focus:outline-none focus:border-red-500">
                    </div>
                    <div class="flex items-end">
                        <button type="button" onclick="removeDownloadLink(this)" class="bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded text-sm transition-colors">
                            🗑️ حذف
                        </button>
                    </div>
                </div>
            `;
            container.appendChild(newLinkItem);
        }

        // Remove download link
        function removeDownloadLink(button) {
            const linkItem = button.closest('.download-link-item');
            const container = linkItem.parentNode;
            if (container.children.length > 1) {
                linkItem.remove();
            } else {
                showNotification('حداقل یک لینک دانلود باید وجود داشته باشد', 'warning');
            }
        }

        // Reset download links
        function resetDownloadLinks(containerId) {
            const container = document.getElementById(containerId);
            const firstItem = container.querySelector('.download-link-item');
            container.innerHTML = '';
            container.appendChild(firstItem.cloneNode(true));
            // Clear values
            container.querySelectorAll('input, select').forEach(input => {
                if (input.type !== 'button') {
                    input.value = input.type === 'select-one' && input.name === 'downloadQuality[]' ? '1080p' : '';
                }
            });
        }

        // View download links
        function viewDownloadLinks(id, type) {
            const data = dataManager.getData();
            const item = type === 'movie' ? 
                data.movies.find(m => m.id === id) : 
                data.series.find(s => s.id === id);
            
            if (!item || !item.downloadLinks) {
                showNotification('لینک دانلودی یافت نشد', 'warning');
                return;
            }

            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-gray-900 rounded-lg max-w-2xl w-full border border-red-500 p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-bold text-white">لینک‌های دانلود: ${item.name}</h3>
                        <button onclick="this.closest('.fixed').remove()" class="text-red-400 hover:text-red-300 text-2xl">✕</button>
                    </div>
                    
                    <div class="space-y-4">
                        ${item.downloadLinks.map(link => `
                            <div class="bg-gray-800 rounded-lg p-4 border border-gray-700">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <div class="text-white font-medium">کیفیت: ${link.quality}</div>
                                        <div class="text-gray-400 text-sm">حجم: ${link.size || 'نامشخص'}</div>
                                    </div>
                                    <a href="${link.link}" target="_blank" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors">
                                        دانلود
                                    </a>
                                </div>
                                <div class="mt-2 text-xs text-gray-500 break-all">${link.link}</div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="mt-6">
                        <button onclick="this.closest('.fixed').remove()" class="w-full bg-gray-700 hover:bg-gray-600 text-white py-2 px-4 rounded-lg transition-colors">
                            بستن
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Delete functions
        function deleteMovie(id) {
            if (confirm('آیا از حذف این فیلم اطمینان دارید؟')) {
                if (dataManager.deleteMovie(id)) {
                    loadMoviesTable();
                    updateStats();
                    showNotification('فیلم با موفقیت حذف شد', 'success');
                }
            }
        }

        function deleteSeries(id) {
            if (confirm('آیا از حذف این سریال اطمینان دارید؟')) {
                if (dataManager.deleteSeries(id)) {
                    loadSeriesTable();
                    updateStats();
                    showNotification('سریال با موفقیت حذف شد', 'success');
                }
            }
        }

        // Utility functions
        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            const colors = {
                success: 'bg-green-600',
                error: 'bg-red-600',
                info: 'bg-blue-600',
                warning: 'bg-yellow-600'
            };
            
            notification.className = `notification fixed top-20 right-6 ${colors[type]} text-white px-6 py-3 rounded-lg shadow-lg z-50`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Listen for storage changes
        window.addEventListener('storage', function(e) {
            if (e.key === dataManager.storageKey) {
                updateStats();
                loadMoviesTable();
                loadSeriesTable();
                loadUsersTable();
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99280365d1197747',t:'MTc2MTEyNTgxNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
